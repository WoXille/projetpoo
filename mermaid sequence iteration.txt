sequenceDiagram
    participant M as main
    participant G as Game
    participant R as Regle
    participant GR as Grille
    participant C as Cell
    participant E as CellEtat

    M->>G: runIteration(R)
    activate G

    loop pour chaque cellule (i,j)
        G->>GR: getCell(i,j)
        GR-->>G: pointeur vers C

        G->>C: estObstacle()
        C->>E: estObstacle()
        E-->>C: bool obstacle
        C-->>G: bool obstacle

        alt cellule obstacle
            Note right of C: La cellule n'évolue pas<br/>(ne change jamais d'état)
        else cellule normale
            %% Comptage des voisins vivants
            loop pour chaque voisin
                G->>GR: getCell(x_voisin, y_voisin)
                GR-->>G: voisin = Cell

                G->>voisin: estVivante()
                voisin->>E: estVivante()
                E-->>voisin: bool vivant
                voisin-->>G: bool vivant
            end

            alt cellule vivante
                G->>R: get_voisins_min()
                R-->>G: min
                G->>R: get_voisins_max()
                R-->>G: max

                alt nbVoisins < min ou nbVoisins > max
                    G->>C: RendreMorte()
                    C->>E: changer état → CellMorte
                else
                    Note right of C: reste vivante
                end

            else cellule morte
                G->>R: get_naissance()
                R-->>G: naissance

                alt nbVoisins == naissance
                    G->>C: RendreVivante()
                    C->>E: changer état → CellVivante
                else
                    Note right of C: reste morte
                end
            end
        end
    end

    deactivate G
    G-->>M: fin de runIteration